<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Operacional LogÃ­stico</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:'Segoe UI',Arial,sans-serif;
  background:#f1f5f9;
}

/* HEADER */
header{
  background:linear-gradient(90deg,#1e3a8a,#dc2626);
  color:#fff;
  padding:25px;
  text-align:center;
  position:relative;
}

.logout-btn{
  position:absolute;
  right:20px;
  top:20px;
  background:#dc2626;
  border:none;
  color:#fff;
  padding:8px 14px;
  border-radius:6px;
  cursor:pointer;
}

/* MAIN */
main{
  padding:40px;
  max-width:1200px;
  margin:auto;
}

/* KPI */
.kpi-container{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  margin-bottom:40px;
}

.kpi-card{
  background:#ffffff;
  border-radius:16px;
  padding:25px;
  box-shadow:0 6px 18px rgba(0,0,0,0.08);
  display:flex;
  align-items:center;
  justify-content:space-between;
  transition:.3s;
}

.kpi-card:hover{
  transform:translateY(-4px);
}

.kpi-title{
  font-size:13px;
  color:#64748b;
  margin-bottom:6px;
}

.kpi-number{
  font-size:28px;
  font-weight:700;
}

.kpi-icon{
  width:55px;
  height:55px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:24px;
  color:#fff;
}

.bg-blue{background:#1e3a8a;}
.bg-green{background:#16a34a;}
.bg-red{background:#dc2626;}
.bg-orange{background:#ea580c;}

/* GRID CARDS */
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
  gap:25px;
}

.card{
  background:#fff;
  border-radius:14px;
  padding:25px;
  text-align:center;
  text-decoration:none;
  color:#1f2937;
  box-shadow:0 6px 18px rgba(0,0,0,0.08);
  transition:.3s;
}

.card:hover{
  transform:translateY(-6px);
  box-shadow:0 12px 28px rgba(0,0,0,0.15);
}

.icon{font-size:40px;margin-bottom:12px;}
.title{font-size:17px;font-weight:600;margin-bottom:8px;}

footer{
  text-align:center;
  padding:20px;
  font-size:12px;
  color:#64748b;
}
</style>
</head>

<body>

<header>
<button class="logout-btn" onclick="logout()">Sair</button>
<h1>ğŸšš Painel Operacional LogÃ­stico</h1>
<p>Central Operacional da Frota</p>
<p id="usuarioLogado" style="margin-top:8px;font-size:13px;opacity:.9;"></p>
</header>

<main>

<!-- KPI OPERACIONAL -->
<div class="kpi-container" id="kpiContainer">

  <div class="kpi-card">
    <div>
      <div class="kpi-title">Total CaminhÃµes</div>
      <div class="kpi-number" id="kpiCaminhoes">0</div>
    </div>
    <div class="kpi-icon bg-green">ğŸš›</div>
  </div>

  <div class="kpi-card">
    <div>
      <div class="kpi-title">DisponÃ­veis</div>
      <div class="kpi-number" id="kpiDisponiveis">0</div>
    </div>
    <div class="kpi-icon bg-blue">ğŸŸ¢</div>
  </div>

  <div class="kpi-card">
    <div>
      <div class="kpi-title">Na Fila</div>
      <div class="kpi-number" id="kpiFila">0</div>
    </div>
    <div class="kpi-icon bg-orange">ğŸ•’</div>
  </div>

  <div class="kpi-card">
    <div>
      <div class="kpi-title">Em Atendimento</div>
      <div class="kpi-number" id="kpiAtendimento">0</div>
    </div>
    <div class="kpi-icon bg-red">ğŸš§</div>
  </div>

</div>

<!-- CARDS DE SISTEMA -->
<div class="cards">

<a class="card" href="index.html">
  <div class="icon">ğŸ›ï¸</div>
  <div class="title">Painel da Fila</div>
</a>

<a class="card" href="motoristas.html">
  <div class="icon">ğŸ“</div>
  <div class="title">Disponibilidade Motoristas</div>
</a>

<a class="card" href="motoristas-admin.html">
  <div class="icon">ğŸ‘¤</div>
  <div class="title">AdministraÃ§Ã£o Motoristas</div>
</a>

<a class="card" href="frete.html">
  <div class="icon">ğŸ§®</div>
  <div class="title">CÃ¡lculo de Frete</div>
</a>

</div>

</main>

<footer>
2026 Â· Sistema Operacional LogÃ­stico - Â© Renato Monteiro
</footer>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const app = initializeApp({
  apiKey:"AIzaSyCKdfOvWehaJcuK6uX5JXxc7YdN26h8sXY",
  authDomain:"tabela-frete-rio-branco.firebaseapp.com",
  projectId:"tabela-frete-rio-branco"
});

const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth, async (user)=>{
  if(!user){ window.location.href="login.html"; return; }

  document.getElementById("usuarioLogado").innerText =
    "UsuÃ¡rio autenticado";

  carregarKPIs();
});

async function carregarKPIs(){

  const motoristasSnap = await getDocs(collection(db,"motoristas"));
  const filaSnap = await getDocs(collection(db,"fila"));

  let total = motoristasSnap.size;
  let disponiveis = 0;
  let atendimento = 0;

  motoristasSnap.forEach(doc=>{
    const d = doc.data();
    if(d.status === "DISPONÃVEL") disponiveis++;
    if(d.status === "EM_ATENDIMENTO") atendimento++;
  });

  document.getElementById("kpiCaminhoes").innerText = total;
  document.getElementById("kpiDisponiveis").innerText = disponiveis;
  document.getElementById("kpiFila").innerText = filaSnap.size;
  document.getElementById("kpiAtendimento").innerText = atendimento;
}

window.logout=()=>signOut(auth).then(()=>window.location.href="login.html");

</script>

</body>
</html>
