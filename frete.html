<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Cálculo de Frete por Rota</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{ --azul:#0d47a1; --vermelho:#c62828; }
body{
  margin:0; padding:20px;
  font-family:Arial, Helvetica, sans-serif;
  background:linear-gradient(135deg,var(--azul),var(--vermelho));
}
.container{
  max-width:1200px; margin:auto; background:#fff;
  border-radius:12px; box-shadow:0 20px 40px rgba(0,0,0,.35);
}
.header{
  background:linear-gradient(90deg,var(--azul),var(--vermelho));
  color:#fff; padding:18px; text-align:center;
}
.content{ padding:25px; }
label{ font-weight:bold; font-size:13px; }
input,select{
  width:100%; padding:8px; border:1px solid #ccc;
  border-radius:5px; font-size:13px;
}
input:disabled,select:disabled{ background:#eee; cursor:not-allowed; }
.uppercase{
  text-transform:uppercase;
}
.grid{
  display:grid; grid-template-columns:2fr 1fr;
  gap:15px; margin-bottom:20px;
}
table{
  width:100%; border-collapse:collapse; margin-top:15px;
}
th,td{
  border:1px solid #999; padding:6px;
  font-size:12.5px; text-align:center;
}
th{ background:#e3f2fd; }
.total{ font-weight:bold; }
button{
  width:100%; padding:14px; margin-top:20px;
  background:linear-gradient(90deg,var(--azul),var(--vermelho));
  color:#fff; border:none; border-radius:8px;
  font-size:16px; cursor:pointer;
}
.resumo-box{
  margin-top:30px; border:3px solid var(--azul);
  padding:20px; border-radius:10px; background:#f9fbff;
}
.resumo-box h3{ margin-top:0; text-align:center; color:var(--azul); }

@media print{
  body{ background:#fff; padding:0; }
  .header,.grid,button{ display:none; }
  .container{ box-shadow:none; }
}
</style>
</head>

<body>

<div class="container">
  <div class="header">
    <h2>CÁLCULO DE FRETE POR ROTA</h2>
  </div>

  <div class="content">

    <div class="grid">
      <div>
        <label>Tipo de Caminhão</label>
        <select id="tipo" onchange="gerarTabela()">
          <option value="">Selecione</option>
          <option value="FROTA">FROTA</option>
          <option value="BITRUCK">BITRUCK</option>
          <option value="TRUCK_555">TRUCK 555</option>
          <option value="TRUCK_5532">TRUCK 5532</option>
          <option value="TRUCK_53232">TRUCK 53232</option>
          <option value="TOCO">TOCO</option>
          <option value="CARRETA">CARRETA</option>
        </select>
      </div>
      <div>
        <label>KM TOTAL DA ROTA</label>
        <input type="number" id="kmTotal">
      </div>
    </div>

    <div id="tabela"></div>

    <button onclick="calcular()">Calcular Frete</button>

    <div id="resumo"></div>

  </div>
</div>

<script>
/* ===== DADOS BASE ===== */
const base = {
  FROTA:   { indice:5.8402, taxa:669.32 },
  BITRUCK: { indice:3.5686, taxa:364.71 },
  TRUCK:   { indice:4.4266, taxa:412.57 },
  TOCO:    { indice:4.9381, taxa:414.93 },
  CARRETA: { indice:5.6203, taxa:460.29 }
};

/* ===== COMPARTIMENTOS ===== */
const compartimentos = {
  FROTA: [5000,5000,5000,2500,2500,2500],
  BITRUCK: [5000,5000,5000],
  TRUCK_555: [5000,5000,5000],
  TRUCK_5532: [5000,5000,3000,2000],
  TRUCK_53232: [5000,3000,2000,3000,2000],
  TOCO: [5000,3000,2000],
  CARRETA: [5000,5000,5000,5000,5000,5000]
};

function dadosCaminhao(tipo){
  if(tipo.startsWith("TRUCK")) return base.TRUCK;
  return base[tipo];
}

/* ===== FORMATAÇÃO ===== */
function moeda(v){
  return v.toLocaleString("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2});
}
function moeda4(v){
  return v.toLocaleString("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:4});
}
function numero(v){
  return v.toLocaleString("pt-BR");
}

function gerarTabela(){
  const tipo=document.getElementById("tipo").value;
  if(!tipo){ document.getElementById("tabela").innerHTML=""; return; }

  let html=`<table>
  <tr>
    <th>CLIENTE</th><th>CIDADE</th><th>HORÁRIO</th>
    <th>QUANTIDADE (L)</th><th>FRETE (R$/L)</th><th>TOTAL (R$)</th><th>VENDEDOR</th>
  </tr>`;

  compartimentos[tipo].forEach((l,i)=>{
    html+=`
    <tr>
      <td><input class="uppercase" oninput="this.value=this.value.toUpperCase()" id="cliente${i}"></td>
      <td><input class="uppercase" oninput="this.value=this.value.toUpperCase()" id="cidade${i}"></td>
      <td><input type="time" id="horario${i}"></td>
      <td>${numero(l)}</td>
      <td id="unit${i}">-</td>
      <td id="frete${i}">-</td>
      <td><input class="uppercase" oninput="this.value=this.value.toUpperCase()" id="vendedor${i}"></td>
    </tr>`;
  });

  html+="</table>";
  document.getElementById("tabela").innerHTML=html;
}

function calcular(){
  const tipo=document.getElementById("tipo").value;
  const km=parseFloat(document.getElementById("kmTotal").value);
  if(!tipo||!km) return alert("Informe tipo e KM.");

  const d=dadosCaminhao(tipo);
  const litrosArr=compartimentos[tipo];

  let litrosUsados=0;
  let usados=[];

  litrosArr.forEach((l,i)=>{
    if(document.getElementById("cliente"+i).value.trim()){
      litrosUsados+=l;
      usados.push(i);
    }
  });

  if(litrosUsados===0){
    alert("Informe pelo menos um cliente.");
    return;
  }

  const freteTotal=(km*d.indice)+d.taxa;
  const unit=freteTotal/litrosUsados;

  let html=`<div class="resumo-box">
  <h3>Resumo de Frete por Rota</h3>
  <table>
  <tr>
    <th>CLIENTE</th><th>CIDADE</th><th>HORÁRIO</th>
    <th>FRETE</th><th>QUANTIDADE</th><th>TOTAL</th><th>VENDEDOR</th>
  </tr>`;

  usados.forEach(i=>{
    const l=litrosArr[i];
    const total=l*unit;
    document.getElementById("unit"+i).innerText=moeda4(unit);
    document.getElementById("frete"+i).innerText=moeda(total);

    html+=`
    <tr>
      <td>${document.getElementById("cliente"+i).value}</td>
      <td>${document.getElementById("cidade"+i).value}</td>
      <td>${document.getElementById("horario"+i).value}</td>
      <td>${moeda4(unit)}</td>
      <td>${numero(l)}</td>
      <td>${moeda(total)}</td>
      <td>${document.getElementById("vendedor"+i).value}</td>
    </tr>`;
  });

  html+=`
  <tr class="total">
    <td colspan="4"></td>
    <td>${numero(litrosUsados)}</td>
    <td>${moeda(freteTotal)}</td>
    <td></td>
  </tr>
  </table>

  <table style="margin-top:15px">
  <tr>
    <th>KM RODADO</th><th>ÍNDICE</th><th>TAXA</th>
    <th>TOTAL FRETE</th><th>M³</th><th>FRETE UNIT MÉDIO</th>
  </tr>
  <tr>
    <td>${numero(km)}</td>
    <td>${d.indice.toFixed(4)}</td>
    <td>${moeda(d.taxa)}</td>
    <td>${moeda(freteTotal)}</td>
    <td>${numero(litrosUsados/1000)}</td>
    <td>${moeda4(unit)}</td>
  </tr>
  </table></div>`;

  document.getElementById("resumo").innerHTML=html;

  /* ===== TRAVA DEFINITIVA ===== */
  document.querySelectorAll("input,select").forEach(el=>el.disabled=true);
}
</script>

</body>
</html>
